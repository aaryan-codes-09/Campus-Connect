{% extends 'base.html' %}
{% block title %}Organizer Dashboard â€“ CampusConnect{% endblock %}
{% block page_title %}Organizer Dashboard{% endblock %}
{% block content %}
<div class="page-header d-flex justify-content-between align-items-start flex-wrap gap-3">
  <div>
    <div class="page-header-title">{{ current_user.full_name }} <span style="font-size:1rem;opacity:.6">ðŸŽª</span></div>
    <div class="page-header-sub"><span class="badge-pill badge-coral me-2">Organizer</span><span class="badge-pill badge-muted">{{ current_user.department }}</span></div>
  </div>
  <div class="d-flex gap-2">
    <a href="/events/create" class="btn btn-teal"><i class="fas fa-plus me-2"></i>Create Event</a>
    <a href="/memories/upload" class="btn btn-ghost"><i class="fas fa-upload me-2"></i>Upload Memories</a>
  </div>
</div>
<div class="page-content">
  <div class="row g-3 mb-4">
    <div class="col-6 col-md-4"><div class="stat-card"><div class="stat-icon stat-icon-teal"><i class="fas fa-calendar-star"></i></div><div><div class="stat-num">{{ stats.my_events }}</div><div class="stat-label">My Events</div></div></div></div>
    <div class="col-6 col-md-4"><div class="stat-card"><div class="stat-icon stat-icon-amber"><i class="fas fa-users"></i></div><div><div class="stat-num">{{ stats.total_regs }}</div><div class="stat-label">Total Registrations</div></div></div></div>
    <div class="col-6 col-md-4"><div class="stat-card"><div class="stat-icon stat-icon-coral"><i class="fas fa-images"></i></div><div><div class="stat-num">{{ stats.memories }}</div><div class="stat-label">Memories Uploaded</div></div></div></div>
  </div>
  <div class="row g-4">
    <div class="col-lg-8">
      <div class="card mb-4">
        <div class="card-header"><div class="card-header-title"><i class="fas fa-calendar-star"></i>My Events</div><a href="/events/create" class="btn btn-teal btn-sm">+ Create</a></div>
        <div class="card-body p-0">
          {% if my_events %}
          <table class="table mb-0">
            <thead><tr><th>Event</th><th>Date</th><th>Registrations</th><th>Status</th></tr></thead>
            <tbody>
              {% for ev in my_events %}
              <tr>
                <td><a href="/events/{{ ev.id }}" style="color:var(--c-teal);font-weight:600">{{ ev.title[:35] }}</a></td>
                <td><span style="font-size:.8rem">{{ ev.event_date }}</span></td>
                <td><span style="font-weight:600">{{ ev.rc }}</span><span style="color:var(--c-muted);font-size:.8rem"> / {{ ev.max_participants or 'âˆž' }}</span></td>
                <td><span class="badge-pill {{ 'badge-teal' if ev.status=='upcoming' else 'badge-muted' if ev.status=='completed' else 'badge-amber' }}">{{ ev.status|title }}</span></td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <div style="padding:28px;text-align:center;color:var(--c-muted)"><i class="fas fa-calendar-times" style="font-size:2rem;opacity:.3;margin-bottom:8px;display:block"></i>No events created yet.<div class="mt-2"><a href="/events/create" class="btn btn-teal btn-sm">Create First Event</a></div></div>
          {% endif %}
        </div>
      </div>
      <div class="card">
        <div class="card-header"><div class="card-header-title"><i class="fas fa-images"></i>Recent Memories</div><a href="/memories/upload" class="btn btn-ghost btn-sm">Upload More</a></div>
        <div class="card-body">
          {% if recent_memories %}
          <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:8px">
            {% for m in recent_memories %}
            <div style="border-radius:8px;overflow:hidden;aspect-ratio:1"><img src="/static/uploads/memories/{{ m.image_path }}" style="width:100%;height:100%;object-fit:cover" onerror="this.src='https://via.placeholder.com/100/1a2740/7a95b8?text=Photo'"></div>
            {% endfor %}
          </div>
          {% else %}
          <div style="text-align:center;color:var(--c-muted);font-size:.85rem;padding:16px">No memories uploaded yet.</div>
          {% endif %}
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="card mb-4">
        <div class="card-header"><div class="card-header-title"><i class="fas fa-bolt"></i>Quick Actions</div></div>
        <div class="card-body d-flex flex-column gap-2">
          <a href="/events/create" class="btn btn-teal w-100 text-start"><i class="fas fa-calendar-plus me-2"></i>Create Event</a>
          <a href="/memories/upload" class="btn btn-ghost w-100 text-start"><i class="fas fa-upload me-2"></i>Upload Memories</a>
          <a href="/notices/create" class="btn btn-ghost w-100 text-start"><i class="fas fa-bullhorn me-2"></i>Post Notice</a>
          <a href="/events" class="btn btn-ghost w-100 text-start"><i class="fas fa-calendar me-2"></i>All Events</a>
          <a href="/memories" class="btn btn-ghost w-100 text-start"><i class="fas fa-images me-2"></i>Memory Gallery</a>
        </div>
      </div>

      <!-- My Info -->
      <div class="card" style="color : white">
        <div class="card-header"><div class="card-header-title"><i class="fas fa-info-circle"></i>My Info</div></div>
        <div class="card-body" style="font-size:.85rem">
          <div style="display:flex;flex-direction:column;gap:8px">
            <div style="display:flex;justify-content:space-between"><span style="color:var(--c-muted)">Name</span><strong style="text-align:right;max-width:60%">{{ current_user.full_name }}</strong></div>
            <div class="divider" style="margin:0"></div>
            <div style="display:flex;justify-content:space-between"><span style="color:var(--c-muted)">Department</span><strong style="text-align:right;max-width:60%">{{ (current_user.department or 'N/A')[:25] }}</strong></div>
            <div class="divider" style="margin:0"></div>
            <div style="display:flex;justify-content:space-between"><span style="color:var(--c-muted)">Role</span><strong><span class="badge-pill badge-coral">Organizer</span></strong></div>
            <div class="divider" style="margin:0"></div>
            <div style="display:flex;justify-content:space-between"><span style="color:var(--c-muted)">Email</span><strong style="font-size:.8rem;text-align:right;max-width:60%">{{ current_user.email }}</strong></div>
          </div>
          <a href="/profile/edit" class="btn btn-ghost btn-sm w-100 mt-3">Edit Profile</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
