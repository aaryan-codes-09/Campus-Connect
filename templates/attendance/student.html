{% extends 'base.html' %}
{% block title %}My Attendance â€“ CampusConnect{% endblock %}
{% block page_title %}My Attendance{% endblock %}
{% block content %}
<div class="page-header">
  <div class="page-header-title"><i class="fas fa-qrcode me-2 text-teal"></i>My Attendance Records</div>
  <div class="page-header-sub">Only you can see your own attendance data.</div>
</div>
<div class="page-content">
  <div class="row g-3 mb-4">
    <div class="col-6 col-md-3"><div class="stat-card"><div class="stat-icon stat-icon-teal"><i class="fas fa-check-circle"></i></div><div><div class="stat-num">{{ my_records|length }}</div><div class="stat-label">Sessions Attended</div></div></div></div>
    <div class="col-6 col-md-3"><div class="stat-card"><div class="stat-icon stat-icon-amber"><i class="fas fa-calendar"></i></div><div><div class="stat-num">{{ total_sessions }}</div><div class="stat-label">Total Sessions</div></div></div></div>
    <div class="col-6 col-md-3"><div class="stat-card"><div class="stat-icon stat-icon-coral"><i class="fas fa-percentage"></i></div><div><div class="stat-num">{{ ((my_records|length / total_sessions * 100)|int if total_sessions > 0 else 0) }}%</div><div class="stat-label">Attendance Rate</div></div></div></div>
  </div>

  <div class="card">
    <div class="card-header"><div class="card-header-title"><i class="fas fa-list"></i>Attendance Log</div></div>
    <div class="card-body p-0">
      {% if my_records %}
      <table class="table mb-0">
        <thead><tr><th>#</th><th>Subject</th><th>Department</th><th>Date</th><th>Marked At</th><th>Method</th></tr></thead>
        <tbody>
          {% for r in my_records %}
          <tr>
            <td style="font-size:.8rem;color:var(--c-muted)">{{ loop.index }}</td>
            <td style="font-weight:600">{{ r.subject }}</td>
            <td><span style="font-size:.8rem;color:var(--c-muted)">{{ r.department }}</span></td>
            <td><span style="font-size:.8rem">{{ r.date }}</span></td>
            <td><span style="font-size:.8rem;color:var(--c-muted)">{{ r.marked_at[11:16] }}</span></td>
            <td><span class="badge-pill badge-teal" style="font-size:.65rem"><i class="fas fa-qrcode me-1"></i>QR Scan</span></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <div style="padding:40px;text-align:center;color:var(--c-muted)">
        <i class="fas fa-qrcode" style="font-size:3rem;opacity:.25;margin-bottom:16px;display:block"></i>
        <h5>No attendance records yet.</h5>
        <p style="font-size:.85rem">Scan your teacher's QR code in class to mark attendance.</p>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
